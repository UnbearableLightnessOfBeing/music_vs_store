{{ define "web/product.html" }} {{ template "layouts/header.html" . }}
<div class="flex flex-col min-h-screen">
  <div class="flex-1 mx-auto">
    <section class="w-full py-12 md:py-24 lg:py-32">
      <div class="container grid grid-cols-1 md:grid-cols-[1fr_1.5fr] gap-8 px-4 md:px-6 max-w-[1200px]">
        <div class="grid gap-4">
          <section id="main-carousel" class="splide border border-gray-100 rounded-xl overflow-hidden">
            <div class="splide__track">
              <ul class="splide__list">
                {{ if eq (len .product.Images) 0 }}
                  <li class="splide__slide">
                    <img class="w-full h-full object-cover" src="/assets/images/no-image.jpg" alt="image">
                  </li>
                {{ else }}
                  {{ range .product.Images }}
                  <li class="splide__slide h-[650px] max-w-[450px]">
                    <img class="w-full h-full object-contain" src="{{ . }}" alt="image">
                  </li>
                  {{ end }}
                {{ end }}
              </ul>
            </div>
          </section>
          <section id="thumbnail-carousel" class="splide max-w-[450px]">
            <div class="splide__track">
              <ul class="splide__list">
                {{ if eq (len .product.Images) 0 }}
                  <li class="splide__slide">
                    <img class="w-full h-full object-cover" src="/assets/images/no-image.jpg" alt="image">
                  </li>
                {{ else }}
                  {{ range .product.Images }}
                  <li class="splide__slide">
                    <img class="w-full h-full object-cover" src="{{ . }}" alt="image">
                  </li>
                  {{ end }}
                {{ end }}
              </ul>
            </div>
          </section>
        </div>
        <div class="grid gap-6">
          <div>
            <h1 class="text-3xl font-bold">{{ .product.Name }}</h1>
            <div class="flex gap-4">
              <div>ID товара: {{ .product.ID }}</div>
              <div>В наличии: 
                {{ if .product.InStock }} 
                  ДА
                {{ else }}
                  НЕТ
                {{ end }}</div>
            </div>
          </div>
          <div class="max-w-[400px] overflow-hidden overflow-ellipsis">
            <div>Производитель: {{ if .product.LabelID.Valid }} {{ .product.LabelID.Value }} {{ end }}</div>
            <p class="border border-red-400 overflow-hidden overflow-ellipsis line-clamp-5">
              {{ if .product.Description.Valid }} {{ .product.Description.Value }} {{ end }}
            </p>
          </div>
          <div class="flex items-center gap-4">
            <span class="text-4xl font-bold">{{ .product.PriceInt }}.00 руб</span>
          </div>
          <div class="grid gap-4">
            <div class="grid gap-2">
              {{ if .product.InStock }}
              <form 
                class="flex items-center gap-2"
                hx-trigger="click from:#to-cart"
                hx-params="*"
                hx-post="/add-to-cart"
                hx-target="#cart-add-swap"
                hx-swap="outerHTML transition:true"
              >
                <input class="hidden" type="number" name="id" value="{{ .product.ID }}">
                {{ if .isLoggedIn }}
                  {{ if .isProductInCart }}
                    {{ template "components/createdCartItem.html" . }} 
                  {{ else }}
                  <div id="cart-add-swap">
                    <input type="number" name="quantity" value="1">
                    <div id="to-cart" class="px-4 py-2 rounded-md border border-slate-300 cursor-pointer hover:bg-gray-100">В корзину</div>
                  </div>
                  {{ end }}
                <div class="px-4 py-2 rounded-md border border-slate-300 cursor-pointer hover:bg-gray-100">Купить сейчас</div>
                {{ else }}
                <a href="/login" class="hover:underline text-slate-400 hover:text-black">Чтобы купить товар или добавить его в корзину, войдите в аккаунт</a>
                {{ end }}
              </form>
              {{ else }}
              <div>Товара нет в наличии</div>
              {{ end }}
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
{{ template "layouts/footer.html"}} {{ end }}
